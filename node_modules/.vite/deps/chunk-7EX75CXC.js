import {
  AbstractAudioBus,
  init_abstractAudioBus
} from "./chunk-Z4AZCP6Y.js";
import {
  _HasSpatialAudioOptions,
  _SpatialWebAudio,
  _StereoAudio,
  _WebAudioBusAndSoundSubGraph,
  init_abstractSpatialAudio,
  init_spatialWebAudio,
  init_stereoAudio,
  init_webAudioBusAndSoundSubGraph
} from "./chunk-53WJF276.js";
import {
  __esm
} from "./chunk-DZZM6G22.js";

// node_modules/@babylonjs/core/AudioV2/abstractAudio/audioBus.js
var AudioBus;
var init_audioBus = __esm({
  "node_modules/@babylonjs/core/AudioV2/abstractAudio/audioBus.js"() {
    init_abstractAudioBus();
    AudioBus = class extends AbstractAudioBus {
      constructor(name, engine) {
        super(name, engine);
        this._outBus = null;
        this._onOutBusDisposed = () => {
          this.outBus = this.engine.defaultMainBus;
        };
      }
      /**
       * The output bus of the audio bus. Defaults to the audio engine's default main bus.
       */
      get outBus() {
        return this._outBus;
      }
      set outBus(outBus) {
        if (this._outBus === outBus) {
          return;
        }
        if (this._outBus) {
          this._outBus.onDisposeObservable.removeCallback(this._onOutBusDisposed);
          if (!this._disconnect(this._outBus)) {
            throw new Error("Disconnect failed");
          }
        }
        this._outBus = outBus;
        if (this._outBus) {
          this._outBus.onDisposeObservable.add(this._onOutBusDisposed);
          if (!this._connect(this._outBus)) {
            throw new Error("Connect failed");
          }
        }
      }
      /**
       * Releases associated resources.
       */
      dispose() {
        super.dispose();
        this._outBus = null;
      }
    };
  }
});

// node_modules/@babylonjs/core/AudioV2/webAudio/webAudioBus.js
var _WebAudioBus;
var init_webAudioBus = __esm({
  "node_modules/@babylonjs/core/AudioV2/webAudio/webAudioBus.js"() {
    init_audioBus();
    init_abstractSpatialAudio();
    init_stereoAudio();
    init_webAudioBusAndSoundSubGraph();
    init_spatialWebAudio();
    _WebAudioBus = class __WebAudioBus extends AudioBus {
      /** @internal */
      constructor(name, engine, options) {
        super(name, engine);
        this._spatial = null;
        this._spatialAutoUpdate = true;
        this._spatialMinUpdateTime = 0;
        this._stereo = null;
        if (typeof options.spatialAutoUpdate === "boolean") {
          this._spatialAutoUpdate = options.spatialAutoUpdate;
        }
        if (typeof options.spatialMinUpdateTime === "number") {
          this._spatialMinUpdateTime = options.spatialMinUpdateTime;
        }
        this._subGraph = new __WebAudioBus._SubGraph(this);
      }
      /** @internal */
      async _init(options) {
        if (options.outBus) {
          this.outBus = options.outBus;
        } else {
          await this.engine.isReadyPromise;
          this.outBus = this.engine.defaultMainBus;
        }
        await this._subGraph.init(options);
        if (_HasSpatialAudioOptions(options)) {
          this._initSpatialProperty();
        }
        this.engine._addNode(this);
      }
      /** @internal */
      dispose() {
        super.dispose();
        this._spatial = null;
        this._stereo = null;
        this.engine._removeNode(this);
      }
      /** @internal */
      get _inNode() {
        return this._subGraph._inNode;
      }
      /** @internal */
      get _outNode() {
        return this._subGraph._outNode;
      }
      /** @internal */
      get spatial() {
        if (this._spatial) {
          return this._spatial;
        }
        return this._initSpatialProperty();
      }
      /** @internal */
      get stereo() {
        return this._stereo ?? (this._stereo = new _StereoAudio(this._subGraph));
      }
      /** @internal */
      getClassName() {
        return "_WebAudioBus";
      }
      _connect(node) {
        var _a;
        const connected = super._connect(node);
        if (!connected) {
          return false;
        }
        if (node._inNode) {
          (_a = this._outNode) == null ? void 0 : _a.connect(node._inNode);
        }
        return true;
      }
      _disconnect(node) {
        var _a;
        const disconnected = super._disconnect(node);
        if (!disconnected) {
          return false;
        }
        if (node._inNode) {
          (_a = this._outNode) == null ? void 0 : _a.disconnect(node._inNode);
        }
        return true;
      }
      _initSpatialProperty() {
        if (!this._spatial) {
          this._spatial = new _SpatialWebAudio(this._subGraph, this._spatialAutoUpdate, this._spatialMinUpdateTime);
        }
        return this._spatial;
      }
    };
    _WebAudioBus._SubGraph = class extends _WebAudioBusAndSoundSubGraph {
      get _downstreamNodes() {
        return this._owner._downstreamNodes ?? null;
      }
      get _upstreamNodes() {
        return this._owner._upstreamNodes ?? null;
      }
    };
  }
});

export {
  AudioBus,
  init_audioBus,
  _WebAudioBus,
  init_webAudioBus
};
//# sourceMappingURL=chunk-7EX75CXC.js.map
